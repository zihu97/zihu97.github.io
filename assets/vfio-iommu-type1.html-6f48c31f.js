const t=JSON.parse('{"key":"v-07be0fa4","path":"/posts/linux/vfio/vfio-iommu-type1.html","title":"VFIO框架源码分析（三）- IOMMU后端Type1驱动与DMA隔离","lang":"zh-CN","frontmatter":{"date":"2025-11-18T00:00:00.000Z","article":true,"category":["tech"],"tag":["vfio"],"description":"VFIO框架源码分析（三）- IOMMU后端Type1驱动与DMA隔离 引言与整体框架 前面的文章我们已经剖析了VFIO的核心框架和面向PCI总线的vfio-pci驱动。然而，VFIO实现安全设备直通的基石——IOMMU（Input-Output Memory Management Unit）——是由一个独立的后端模块来管理的。vfio-iommu-type1 就是其IOMMU后端驱动。它利用内核原生的IOMMU API，为VFIO Container提供DMA地址翻译和内存保护服务。 当用户空间通过 VFIO_SET_IOMMU ioctl 为一个Container选择 VFIO_TYPE1_IOMMU 后端时，vfio-iommu-type1 驱动便正式接管了这个Container的内存管理。本文将详细解读该驱动的内部机制，重点分析它是如何为用户空间内存建立安全的IOMMU映射，从而允许直通设备进行DMA操作的。","head":[["meta",{"property":"og:url","content":"https://zihu97.github.io/posts/linux/vfio/vfio-iommu-type1.html"}],["meta",{"property":"og:site_name","content":"紫狐"}],["meta",{"property":"og:title","content":"VFIO框架源码分析（三）- IOMMU后端Type1驱动与DMA隔离"}],["meta",{"property":"og:description","content":"VFIO框架源码分析（三）- IOMMU后端Type1驱动与DMA隔离 引言与整体框架 前面的文章我们已经剖析了VFIO的核心框架和面向PCI总线的vfio-pci驱动。然而，VFIO实现安全设备直通的基石——IOMMU（Input-Output Memory Management Unit）——是由一个独立的后端模块来管理的。vfio-iommu-type1 就是其IOMMU后端驱动。它利用内核原生的IOMMU API，为VFIO Container提供DMA地址翻译和内存保护服务。 当用户空间通过 VFIO_SET_IOMMU ioctl 为一个Container选择 VFIO_TYPE1_IOMMU 后端时，vfio-iommu-type1 驱动便正式接管了这个Container的内存管理。本文将详细解读该驱动的内部机制，重点分析它是如何为用户空间内存建立安全的IOMMU映射，从而允许直通设备进行DMA操作的。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://zihu97.github.io/"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-11-19T14:03:53.000Z"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:alt","content":"VFIO框架源码分析（三）- IOMMU后端Type1驱动与DMA隔离"}],["meta",{"property":"article:author","content":"紫狐"}],["meta",{"property":"article:tag","content":"vfio"}],["meta",{"property":"article:published_time","content":"2025-11-18T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-11-19T14:03:53.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"VFIO框架源码分析（三）- IOMMU后端Type1驱动与DMA隔离\\",\\"image\\":[\\"https://zihu97.github.io/\\"],\\"datePublished\\":\\"2025-11-18T00:00:00.000Z\\",\\"dateModified\\":\\"2025-11-19T14:03:53.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"紫狐\\",\\"url\\":\\"https://zihu97.github.io/\\"}]}"]]},"headers":[{"level":2,"title":"引言与整体框架","slug":"引言与整体框架","link":"#引言与整体框架","children":[]},{"level":2,"title":"分步详解：核心功能实现","slug":"分步详解-核心功能实现","link":"#分步详解-核心功能实现","children":[{"level":3,"title":"Group的附加 (attach_group)","slug":"group的附加-attach-group","link":"#group的附加-attach-group","children":[]},{"level":3,"title":"核心控制接口 (ioctl)","slug":"核心控制接口-ioctl","link":"#核心控制接口-ioctl","children":[]}]},{"level":2,"title":"总结","slug":"总结","link":"#总结","children":[]},{"level":2,"title":"关于作者","slug":"关于作者","link":"#关于作者","children":[]}],"git":{"createdTime":1763561033000,"updatedTime":1763561033000,"contributors":[{"name":"zihu97","email":"zihu@chipltech.com","commits":1}]},"readingTime":{"minutes":5.22,"words":1565},"filePathRelative":"posts/linux/vfio/vfio-iommu-type1.md","localizedDate":"2025年11月18日","excerpt":"<h1> VFIO框架源码分析（三）- IOMMU后端Type1驱动与DMA隔离</h1>\\n<h2> 引言与整体框架</h2>\\n<p>前面的文章我们已经剖析了VFIO的核心框架和面向PCI总线的<code>vfio-pci</code>驱动。然而，VFIO实现安全设备直通的基石——IOMMU（Input-Output Memory Management Unit）——是由一个独立的后端模块来管理的。<code>vfio-iommu-type1</code> 就是其IOMMU后端驱动。它利用内核原生的IOMMU API，为VFIO Container提供DMA地址翻译和内存保护服务。</p>\\n<p>当用户空间通过 <code>VFIO_SET_IOMMU</code> ioctl 为一个Container选择 <code>VFIO_TYPE1_IOMMU</code> 后端时，<code>vfio-iommu-type1</code> 驱动便正式接管了这个Container的内存管理。本文将详细解读该驱动的内部机制，重点分析它是如何为用户空间内存建立安全的IOMMU映射，从而允许直通设备进行DMA操作的。</p>","autoDesc":true}');export{t as data};
