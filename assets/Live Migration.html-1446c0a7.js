const e=JSON.parse('{"key":"v-8717eaa6","path":"/posts/linux/virtualization/qemu/Live-Migration/Live%20Migration.html","title":"VFIO框架源码分析（十一）- QEMU VFIO 实时迁移 (Live Migration) 架构深度解析","lang":"zh-CN","frontmatter":{"date":"2025-11-28T00:00:00.000Z","article":true,"category":["tech"],"tag":["vfio","qemu"],"description":"VFIO框架源码分析（十一）- QEMU VFIO 实时迁移 (Live Migration) 架构深度解析 一、 背景与核心挑战 在虚拟化场景下，设备的实时迁移 (Live Migration) 一直是“直通设备 (Passthrough Device)”的阿喀琉斯之踵。 纯模拟设备 (Virtio)：状态完全在内存中（QEMU 进程内），迁移就是简单的内存拷贝。 直通设备 (VFIO)：设备状态散落在硬件内部的寄存器、SRAM、甚至是正在处理的 Pipeline 中。对 Hypervisor (QEMU) 来说，这是一个黑盒。","head":[["meta",{"property":"og:url","content":"https://zihu97.github.io/posts/linux/virtualization/qemu/Live-Migration/Live%20Migration.html"}],["meta",{"property":"og:site_name","content":"紫狐"}],["meta",{"property":"og:title","content":"VFIO框架源码分析（十一）- QEMU VFIO 实时迁移 (Live Migration) 架构深度解析"}],["meta",{"property":"og:description","content":"VFIO框架源码分析（十一）- QEMU VFIO 实时迁移 (Live Migration) 架构深度解析 一、 背景与核心挑战 在虚拟化场景下，设备的实时迁移 (Live Migration) 一直是“直通设备 (Passthrough Device)”的阿喀琉斯之踵。 纯模拟设备 (Virtio)：状态完全在内存中（QEMU 进程内），迁移就是简单的内存拷贝。 直通设备 (VFIO)：设备状态散落在硬件内部的寄存器、SRAM、甚至是正在处理的 Pipeline 中。对 Hypervisor (QEMU) 来说，这是一个黑盒。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://zihu97.github.io/"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-11-24T13:39:03.000Z"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:alt","content":"VFIO框架源码分析（十一）- QEMU VFIO 实时迁移 (Live Migration) 架构深度解析"}],["meta",{"property":"article:author","content":"紫狐"}],["meta",{"property":"article:tag","content":"vfio"}],["meta",{"property":"article:tag","content":"qemu"}],["meta",{"property":"article:published_time","content":"2025-11-28T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-11-24T13:39:03.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"VFIO框架源码分析（十一）- QEMU VFIO 实时迁移 (Live Migration) 架构深度解析\\",\\"image\\":[\\"https://zihu97.github.io/\\"],\\"datePublished\\":\\"2025-11-28T00:00:00.000Z\\",\\"dateModified\\":\\"2025-11-24T13:39:03.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"紫狐\\",\\"url\\":\\"https://zihu97.github.io/\\"}]}"]]},"headers":[{"level":2,"title":"一、 背景与核心挑战","slug":"一、-背景与核心挑战","link":"#一、-背景与核心挑战","children":[]},{"level":2,"title":"二、 核心架构：控制流与数据流","slug":"二、-核心架构-控制流与数据流","link":"#二、-核心架构-控制流与数据流","children":[{"level":3,"title":"1. 控制面：状态机 (State Machine)","slug":"_1-控制面-状态机-state-machine","link":"#_1-控制面-状态机-state-machine","children":[]},{"level":3,"title":"2. 数据面：迁移缓冲区 (Migration Region)","slug":"_2-数据面-迁移缓冲区-migration-region","link":"#_2-数据面-迁移缓冲区-migration-region","children":[]}]},{"level":2,"title":"三、 逐层代码拆解与生命周期分析","slug":"三、-逐层代码拆解与生命周期分析","link":"#三、-逐层代码拆解与生命周期分析","children":[{"level":3,"title":"1. 迁移初始化：vfio_migration_realize","slug":"_1-迁移初始化-vfio-migration-realize","link":"#_1-迁移初始化-vfio-migration-realize","children":[]},{"level":3,"title":"2. 开启脏页追踪：Memory Dirty Tracking","slug":"_2-开启脏页追踪-memory-dirty-tracking","link":"#_2-开启脏页追踪-memory-dirty-tracking","children":[]},{"level":3,"title":"3. 迭代传输阶段：vfio_save_iterate (Pre-Copy)","slug":"_3-迭代传输阶段-vfio-save-iterate-pre-copy","link":"#_3-迭代传输阶段-vfio-save-iterate-pre-copy","children":[]},{"level":3,"title":"4. 停机与最终传输：vfio_save_complete_precopy (Stop-and-Copy)","slug":"_4-停机与最终传输-vfio-save-complete-precopy-stop-and-copy","link":"#_4-停机与最终传输-vfio-save-complete-precopy-stop-and-copy","children":[]},{"level":3,"title":"5. 目标端恢复：vfio_load_state","slug":"_5-目标端恢复-vfio-load-state","link":"#_5-目标端恢复-vfio-load-state","children":[]}]},{"level":2,"title":"四、 深度总结与技术演进","slug":"四、-深度总结与技术演进","link":"#四、-深度总结与技术演进","children":[{"level":3,"title":"1. 架构优势","slug":"_1-架构优势","link":"#_1-架构优势","children":[]},{"level":3,"title":"2. 未来的演进 (Linux 6.6+ & AI Chip)","slug":"_2-未来的演进-linux-6-6-ai-chip","link":"#_2-未来的演进-linux-6-6-ai-chip","children":[]}]},{"level":2,"title":"关于作者","slug":"关于作者","link":"#关于作者","children":[]}],"git":{"createdTime":1763991543000,"updatedTime":1763991543000,"contributors":[{"name":"zihu97","email":"zihu@chipltech.com","commits":1}]},"readingTime":{"minutes":4.7,"words":1409},"filePathRelative":"posts/linux/virtualization/qemu/Live-Migration/Live Migration.md","localizedDate":"2025年11月28日","excerpt":"<h1> VFIO框架源码分析（十一）- QEMU VFIO 实时迁移 (Live Migration) 架构深度解析</h1>\\n<h2> 一、 背景与核心挑战</h2>\\n<p>在虚拟化场景下，设备的<strong>实时迁移 (Live Migration)</strong> 一直是“直通设备 (Passthrough Device)”的阿喀琉斯之踵。</p>\\n<ul>\\n<li>\\n<p><strong>纯模拟设备 (Virtio)</strong>：状态完全在内存中（QEMU 进程内），迁移就是简单的内存拷贝。</p>\\n</li>\\n<li>\\n<p><strong>直通设备 (VFIO)</strong>：设备状态散落在硬件内部的寄存器、SRAM、甚至是正在处理的 Pipeline 中。对 Hypervisor (QEMU) 来说，这是一个<strong>黑盒</strong>。</p>\\n</li>\\n</ul>","autoDesc":true}');export{e as data};
